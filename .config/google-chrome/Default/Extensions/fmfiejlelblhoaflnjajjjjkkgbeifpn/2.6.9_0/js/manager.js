var debug=!1,manager={language:{},settings:{},domCache:{body:document.body,menu:document.querySelector("ul.menu"),dlSpeed:document.querySelector(".status-panel td.speed.download"),upSpeed:document.querySelector(".status-panel td.speed.upload"),status:document.querySelector(".status-panel td.status div"),statusPanel:document.querySelector(".status-panel"),labelBox:document.querySelector("ul.menu li.select select"),trLayer:document.querySelector(".torrent-list-layer"),trTableMain:document.querySelector(".torrent-table-body"),
trTableFixed:document.querySelector(".torrent-table-head"),trBody:document.querySelector(".torrent-table-body > tbody"),trHead:document.querySelector(".torrent-table-body > thead"),trFixedHead:document.querySelector(".torrent-table-head > thead"),fl:document.querySelector(".file-list"),flLayer:document.querySelector(".file-list > .fl-layer"),flTableMain:document.querySelector(".fl-table-body"),flTableFixed:document.querySelector(".fl-table-head"),flBody:document.querySelector(".fl-table-body > tbody"),
flHead:document.querySelector(".fl-table-body > thead"),flFixedHead:document.querySelector(".fl-table-head > thead"),flBottom:document.querySelector(".file-list ul.bottom-menu"),dropLayer:document.querySelector("div.drop_layer")},varCache:{currentFilter:{label:"ALL",custom:1},trColumnList:{},trListItems:{},trSortColumn:"name",trSortBy:1,trSortList:[],flColumnList:{},flListLayer:{},flListItems:{},flSortColumn:"name",flSortBy:1,flSortList:[],trSelectedHashList:[],flWidth:0,flHeight:0,flLeft:0,flBottomIsHide:0,
flSmartName:{},labels:[],remoteLabels:[],speedLimit:{},folderList:[],labelList:[],webUiUrl:void 0,hasGraph:!1,movebleStyleList:{},cid:void 0,freeSpace:void 0,trLastSelectedHash:[],flLastSelectedHash:[]},options:{scrollWidth:17,trWordWrap:!1,flWordWrap:!0,windowMode:!1,trHasSelectCell:!1,flHasSelectCell:!1},api:function(a,b){a.cid=manager.varCache.cid;mono.sendMessage({action:"api",data:a},b||manager.writeTrList)},moveColumn:function(a,b,c){for(var d=manager.varCache[a+"ColumnArray"],e=-1,f=-1,g,h=
0,k;k=d[h];h++)k.column===b&&(e=h,g=k),k.column===c&&(f=h);-1!==e&&-1!==f&&(d.splice(e,1),d.splice(f,0,g),"tr"===a?(manager.timer.stop(),manager.updateHead(a),manager.trFullUpdatePrepare([]),utils.joinMessages([{action:"getRemoteTorrentList"},{action:"setTrColumnArray",data:manager.varCache.trColumnArray}]).then(function(a){manager.writeTrList({torrents:a.getRemoteTorrentList});manager.timer.start()})):"fl"===a&&(b=manager.varCache.flListLayer,b.param&&(manager.timer.stop(),manager.updateHead(a),
manager.flClearList(),utils.joinMessages([{action:"api",data:b.param},{action:"setFlColumnArray",data:manager.varCache.flColumnArray}]).then(function(a){manager.writeFlList(a.api);manager.timer.start()}))))},onDragStart:function(a){a.dataTransfer.setData("name",a.target.dataset.name);a.dataTransfer.setData("type",a.target.dataset.type)},onDragOver:function(a){var b=a.target;if("TH"===b.tagName||"TH"===b.parentNode.tagName)a.preventDefault(),a.stopPropagation()},onDrop:function(a){a.preventDefault();
a.stopPropagation();var b=a.target;"TH"!==b.tagName&&(b=b.parentNode);if("TH"===b.tagName){var c=b.dataset.type;c===a.dataTransfer.getData("type")&&(b=b.dataset.name,a=a.dataTransfer.getData("name"),b!==a&&manager.moveColumn(c,a,b))}},trWriteHead:function(){var a="",b=0;manager.options.trHasSelectCell=!1;var c=utils.create("tr",{append:function(){for(var c=[],d,g=0,h;h=manager.varCache.trColumnArray[g];g++){var k=h.column;1===h.display&&(c.push(utils.create("th",{class:[k,manager.varCache.trSortColumn!==
k?void 0:1===manager.varCache.trSortBy?"sortDown":"sortUp"],title:manager.language[h.lang],data:{name:k,type:"tr"},draggable:!0,on:[["dragstart",manager.onDragStart],["dragover",manager.onDragOver],["drop",manager.onDrop]],append:["checkbox"===k?utils.create("div",{append:utils.create("input",{type:"checkbox"}),onCreate:function(){manager.options.trHasSelectCell=!0}}):utils.create("div",{text:manager.language[h.lang+"_SHORT"]||manager.language[h.lang]}),d,0===h.order?null:utils.create("i",{class:"arrow"})]})),
d=utils.create("div",{class:"resize-el",draggable:!1,on:[["click",function(a){a.stopPropagation()}],["mousedown",manager.tableResize]]}),a+=".torrent-list-layer th."+k+", .torrent-list-layer td."+k+" {max-width:"+h.width+"px;min-width:"+h.width+"px;}",b+=h.width+2+1+2)}d&&(d.classList.add("last"),c.slice(-1)[0].appendChild(d));return c}()});manager.varCache["style.torrent-style"]&&(manager.varCache["style.torrent-style"].parentNode.removeChild(manager.varCache["style.torrent-style"]),delete manager.varCache["style.torrent-style"]);
document.body.appendChild(manager.varCache["style.torrent-style"]=utils.create("style",{class:"torrent-style",text:a}));--b;manager.options.windowMode||(b+=manager.options.scrollWidth,800<b&&(b=800),723>b&&(b=723),document.body.style.width=b+"px",setTimeout(function(){var a=window.innerWidth;723>a&&a<b&&(document.body.style.minWidth=a+"px",document.body.style.width=a+"px")}));manager.domCache.trFixedHead.appendChild(c);manager.domCache.trHead.appendChild(c.cloneNode(!0));c=document.querySelector("li.graph");
var d=document.querySelector("li.select");c.style.width=d.offsetLeft-c.offsetLeft-5+"px"},flWriteHead:function(){var a="",b=0;manager.options.flHasSelectCell=!1;var c=utils.create("tr",{append:function(){for(var c=[],d,e=0,f;f=manager.varCache.flColumnArray[e];e++){var l=f.column;1===f.display&&(c.push(utils.create("th",{class:[l,manager.varCache.flSortColumn!==l?void 0:1===manager.varCache.flSortBy?"sortDown":"sortUp"],title:manager.language[f.lang],data:{name:l,type:"fl"},draggable:!0,on:[["dragstart",
manager.onDragStart],["dragover",manager.onDragOver],["drop",manager.onDrop]],append:["checkbox"===l?utils.create("div",{append:utils.create("input",{type:"checkbox"}),onCreate:function(){manager.options.flHasSelectCell=!0}}):utils.create("div",{text:manager.language[f.lang+"_SHORT"]||manager.language[f.lang]}),d,0===f.order?null:utils.create("i",{class:"arrow"})]})),d=utils.create("div",{class:"resize-el",on:[["click",function(a){a.stopPropagation()}],["mousedown",manager.tableResize]]}),a+=".fl-layer th."+
l+", .fl-layer td."+l+" {max-width:"+f.width+"px;min-width:"+f.width+"px;}",b+=f.width+2+1+2)}d&&(d.classList.add("last"),c.slice(-1)[0].appendChild(d));return c}()});--b;b+=manager.options.scrollWidth;manager.varCache.flWidth=b;var d=document.body.clientWidth;b>d&&(b=d,a+="div.file-list {max-width:"+d+"px; border-radius: 0;}");100>b?(manager.domCache.flBottom.style.display="none",manager.varCache.flBottomIsHide=1):1===manager.varCache.flBottomIsHide&&(manager.domCache.flBottom.style.display="block",
manager.varCache.flBottomIsHide=0);var e=manager.settings.popupHeight;if(manager.options.windowMode||0===e)e=document.body.clientHeight;e=e-manager.domCache.menu.clientHeight-1-manager.domCache.statusPanel.clientHeight-2;var f=e-manager.domCache.menu.clientHeight;manager.varCache.flHeight=e;manager.varCache.flLeft=(d-b)/2;a+="div.file-list {left: "+manager.varCache.flLeft+"px;height: "+manager.varCache.flHeight+"px;width: "+b+"px;}";a+="div.fl-layer {max-height: "+f+"px;min-height: "+f+"px;}";manager.varCache["style.fileList-style"]&&
(manager.varCache["style.fileList-style"].parentNode.removeChild(manager.varCache["style.fileList-style"]),delete manager.varCache["style.fileList-style"]);document.body.appendChild(manager.varCache["style.fileList-style"]=utils.create("style",{class:"fileList-style",text:a}));manager.domCache.flFixedHead.appendChild(c);manager.domCache.flHead.appendChild(c.cloneNode(!0))},getLabelOptionNode:function(a,b){var c;b&&"NOLABEL"!==a&&(c=!0);return utils.create("option",{value:a,text:b?"SEEDING"===a?manager.language["OV_FL_"+
a.toUpperCase()]:manager.language["OV_CAT_"+a.toUpperCase()]:a,data:b?{image:c?a:void 0,type:"custom"}:void 0})},setLabels:function(a){var b=0,c=manager.varCache.labels=[],d=document.createDocumentFragment(),e=0,f;for(f in manager.trCustomFilterObj)c.push({label:f,custom:1}),d.appendChild(manager.getLabelOptionNode(f,!0)),manager.varCache.currentFilter.custom&&manager.varCache.currentFilter.label===f&&(b=e),e++;for(var g=0;f=a[g];g++)f=f[0],c.push({label:f}),d.appendChild(manager.getLabelOptionNode(f,
!1)),manager.varCache.currentFilter.custom||manager.varCache.currentFilter.label!==f||(b=e),e++;manager.domCache.labelBox.textContent="";manager.domCache.labelBox.appendChild(d);manager.domCache.labelBox.selectedIndex=b;manager.varCache.selectBox&&manager.varCache.selectBox.update()},trCustomFilterObj:{ALL:function(){return!0},DL:function(a){return 1E3!==a.api[4]},SEEDING:function(a){return 201===a.api[1]&&1E3===a.api[4]},COMPL:function(a){return 1E3===a.api[4]},ACTIVE:function(a){return 0!==a.api[9]||
0!==a.api[8]},INACTIVE:function(a){return 0===a.api[9]&&0===a.api[8]},NOLABEL:function(a){return 0===a.api[11].length}},trItemIsInFilter:function(a){return manager.varCache.currentFilter.custom?!manager.trCustomFilterObj[manager.varCache.currentFilter.label](a):!1},trChangeFilterByLabelBox:function(){var a=manager.varCache.currentFilter=manager.varCache.labels[manager.domCache.labelBox.selectedIndex];mono.storage.local.set({selectedLabel:a});manager.varCache["style.tr-filter"]&&manager.varCache["style.tr-filter"].parentNode.removeChild(manager.varCache["style.tr-filter"]);
if(!a.custom)return document.body.appendChild(manager.varCache["style.tr-filter"]=utils.create("style",{class:"tr-filter",text:'.torrent-table-body tbody > tr:not(.selected) {display: none;}.torrent-table-body tbody > tr[data-label="'+a.label+'"] {display: table-row;}'}));for(var b in manager.varCache.trListItems){var c=manager.varCache.trListItems[b];manager.trItemIsInFilter(c)?1===c.display&&(c.node.classList.add("filtered"),c.display=0):1!==c.display&&(c.node.classList.remove("filtered"),c.display=
1)}"all"!==a.label&&document.body.appendChild(manager.varCache["style.tr-filter"]=utils.create("style",{class:"tr-filter",text:".torrent-table-body tbody > tr.filtered:not(.selected){display: none;}"}))},setStatus:function(a){manager.domCache.status.textContent=a;manager.domCache.status.title=a},apiGetDone:function(a,b){a=a[4]/10;b||(a=Math.round(a));return a+"%"},trGetStatusInfo:function(a){var b=a[1],c=a[4];return b&32?b&2?manager.language.OV_FL_CHECKED+" "+manager.apiGetDone(a):manager.language.OV_FL_PAUSED:
b&1?(a=1E3===c?manager.language.OV_FL_SEEDING:manager.language.OV_FL_DOWNLOADING,b&64?a:"[F] "+a):b&2?manager.language.OV_FL_CHECKED+" "+manager.apiGetDone(a):b&16?((b=a[21])&&"en"!==manager.language.lang&&"Error:"===b.substr(0,6)&&(b=manager.language.OV_FL_ERROR+b.substr(5)),b||manager.language.OV_FL_ERROR):b&64?1E3===c?manager.language.OV_FL_QUEUED_SEED:manager.language.OV_FL_QUEUED:1E3==c?manager.language.OV_FL_FINISHED:manager.language.OV_FL_STOPPED},bytesToText:function(a,b,c){c=void 0===c?manager.language.sizeList:
manager.language.sizePsList;c=JSON.parse(c);void 0===b&&(b="n/a");if(0===a)return b;b=parseInt(Math.floor(Math.log(a)/Math.log(1024)));if(0===b)return a/Math.pow(1024,b)+" "+c[b];var d=1;2<b&&(d=2);return(a/Math.pow(1024,b)).toFixed(d)+" "+c[b]},unixTimeToTextOut:function(a){var b=manager.language.timeOutList;b=JSON.parse(b);if(-1===a)return"\u221e";var c=Math.floor(a/60/60/24),d=Math.floor(c/7),e=Math.floor((a-86400*c)/60/60),f=Math.floor((a-86400*c-3600*e)/60),g=Math.floor(a-86400*c-3600*e-60*f);
c=Math.floor(a/60/60/24-7*d);return 10<d?"\u221e":0<d?d+b[0]+" "+c+b[1]:0<c?c+b[1]+" "+e+b[2]:0<e?e+b[2]+" "+f+b[3]:0<f?f+b[3]+" "+g+b[4]:0<g?g+b[4]:"\u221e"},unixTimeToTimeStamp:function(a){if(!a)return"\u221e";a=new Date(1E3*a);var b=a.getMonth()+1;10>b&&(b="0"+b.toString());var c=a.getDate();10>c&&(c="0"+c.toString());var d=a.getHours();10>d&&(d="0"+d.toString());var e=a.getMinutes();10>e&&(e="0"+e.toString());var f=a.getSeconds();10>f&&(f="0"+f.toString());return a.getFullYear()+"-"+b+"-"+c+" "+
d+":"+e+":"+f},trCreateCell:{checkbox:function(a,b){return{node:utils.create("td",{class:a,append:utils.create("input",{type:"checkbox"})})}},name:function(a,b){var c,d;a=utils.create("td",{class:a,append:c=utils.create("div",{append:d=utils.create("span")})});var e=function(a){c.title=a[2];d.textContent=a[2];d.addEventListener("mouseenter",function h(){d.removeEventListener("mouseenter",h);manager.calculateMoveble(this,manager.varCache.trColumnList.name.width)})};e(b);return{node:a,update:e}},order:function(a,
b){var c;a=utils.create("td",{class:a,append:c=utils.create("div")});var d=function(a){a=a[17];0>a&&(a="*");c.textContent=a};d(b);return{node:a,update:d}},size:function(a,b){var c;a=utils.create("td",{class:a,append:c=utils.create("div")});var d=function(a){a=manager.bytesToText(a[3]);c.title=a;c.textContent=a};d(b);return{node:a,update:d}},remaining:function(a,b){var c;a=utils.create("td",{class:a,append:c=utils.create("div")});var d=function(a){a=a[3]-a[5];0>a&&(a=0);c.textContent=manager.bytesToText(a,
0)};d(b);return{node:a,update:d}},done:function(a,b){var c,d;a=utils.create("td",{class:a,append:utils.create("div",{class:"progress_b",append:[c=utils.create("div",{class:"val"}),d=utils.create("div",{class:"progress_b_i"})]})});var e=function(a){var b=201===a[1]&&1E3===a[4]?"#41B541":"#3687ED";c.textContent=manager.apiGetDone(a,1);d.style.width=manager.apiGetDone(a);d.style.backgroundColor=b};e(b);return{node:a,update:e}},status:function(a,b){var c;a=utils.create("td",{class:a,append:c=utils.create("div")});
var d=function(a){a=manager.trGetStatusInfo(a);c.textContent=a;c.title=a};d(b);return{node:a,update:d}},seeds:function(a,b){var c;a=utils.create("td",{class:a,append:c=utils.create("div")});var d=function(a){c.textContent=a[15]};d(b);return{node:a,update:d}},peers:function(a,b){var c;a=utils.create("td",{class:a,append:c=utils.create("div")});var d=function(a){c.textContent=a[13]};d(b);return{node:a,update:d}},seeds_peers:function(a,b){var c;a=utils.create("td",{class:a,append:c=utils.create("div")});
var d=function(a){c.textContent=a[14]+"/"+a[12]};d(b);return{node:a,update:d}},downspd:function(a,b){var c;a=utils.create("td",{class:a,append:c=utils.create("div")});var d=function(a){a=manager.bytesToText(a[9],"",1);c.textContent=a};d(b);return{node:a,update:d}},upspd:function(a,b){var c;a=utils.create("td",{class:a,append:c=utils.create("div")});var d=function(a){a=manager.bytesToText(a[8],"",1);c.textContent=a};d(b);return{node:a,update:d}},eta:function(a,b){var c;a=utils.create("td",{class:a,
append:c=utils.create("div")});var d=function(a){a=manager.unixTimeToTextOut(a[10]);c.textContent=a;c.title=a};d(b);return{node:a,update:d}},upped:function(a,b){var c;a=utils.create("td",{class:a,append:c=utils.create("div")});var d=function(a){a=manager.bytesToText(a[6],0);c.textContent=a};d(b);return{node:a,update:d}},downloaded:function(a,b){var c;a=utils.create("td",{class:a,append:c=utils.create("div")});var d=function(a){a=manager.bytesToText(a[5],0);c.textContent=a};d(b);return{node:a,update:d}},
shared:function(a,b){var c;a=utils.create("td",{class:a,append:c=utils.create("div")});var d=function(a){c.textContent=a[7]/1E3};d(b);return{node:a,update:d}},avail:function(a,b){var c;a=utils.create("td",{class:a,append:c=utils.create("div")});var d=function(a){c.textContent=Math.round(a[16]/65535*1E3)/1E3};d(b);return{node:a,update:d}},label:function(a,b){var c;a=utils.create("td",{class:a,append:c=utils.create("div")});var d=function(a){a=a[11];c.textContent=a;c.title=a};d(b);return{node:a,update:d}},
added:function(a,b){var c;a=utils.create("td",{class:a,append:c=utils.create("div")});var d=function(a){a=manager.unixTimeToTimeStamp(a[23]);c.textContent=a;c.title=a};d(b);return{node:a,update:d}},completed:function(a,b){var c;a=utils.create("td",{class:a,append:c=utils.create("div")});var d=function(a){a=manager.unixTimeToTimeStamp(a[24]);c.textContent=a;c.title=a};d(b);return{node:a,update:d}},actions:function(a,b){return{node:utils.create("td",{class:a,append:utils.create("div",{class:"btns",
append:[utils.create("a",{href:"#start",title:manager.language.ML_START,class:"start"}),utils.create("a",{href:"#pause",title:manager.language.ML_PAUSE,class:"pause"}),utils.create("a",{href:"#stop",title:manager.language.ML_STOP,class:"stop"})]})})}}},trItemCreate:function(a){var b=a.api;a.cell={};a.node=utils.create("tr",{id:b[0],data:{label:b[11],sid:b[22],path:b[26]},append:function(){for(var b=[],d=0,e;e=manager.varCache.trColumnArray[d];d++){var f=e.column;1===e.display&&(e=manager.trCreateCell[f](f,
a.api),a.cell[f]=e.update,b.push(e.node))}return b}()});a.display=1;manager.trItemIsInFilter(a)&&(a.node.classList.add("filtered"),a.display=0)},trGetApiDiff:function(a,b){var c=b;a.length<c.length&&(c=a,a=b);b=[];for(var d=0,e=a.length;d<e;d++)void 0!==manager.trApiIndexToChanges[d]&&a[d]!==c[d]&&b.push(d);return b},trApiIndexToChanges:{1:function(a){a.status=manager.varCache.trColumnList.status.display;a.done=manager.varCache.trColumnList.done.display},2:function(a){a.name=manager.varCache.trColumnList.name.display},
3:function(a){a.size=manager.varCache.trColumnList.size.display;a.remaining=manager.varCache.trColumnList.remaining.display},4:function(a){a.done=manager.varCache.trColumnList.done.display},21:function(a){a.status=manager.varCache.trColumnList.status.display},9:function(a){a.downspd=manager.varCache.trColumnList.downspd.display;a.remaining=manager.varCache.trColumnList.remaining.display},8:function(a){a.upspd=manager.varCache.trColumnList.upspd.display},12:function(a){a.seeds_peers=manager.varCache.trColumnList.seeds_peers.display},
14:function(a){a.seeds_peers=manager.varCache.trColumnList.seeds_peers.display},17:function(a){a.order=manager.varCache.trColumnList.order.display},15:function(a){a.seeds=manager.varCache.trColumnList.seeds.display},13:function(a){a.peers=manager.varCache.trColumnList.peers.display},10:function(a){a.eta=manager.varCache.trColumnList.eta.display},6:function(a){a.upped=manager.varCache.trColumnList.upped.display},5:function(a){a.downloaded=manager.varCache.trColumnList.downloaded.display},7:function(a){a.shared=
manager.varCache.trColumnList.shared.display},16:function(a){a.avail=manager.varCache.trColumnList.avail.display},11:function(a){a.label=manager.varCache.trColumnList.label.display;a.data_label=1},23:function(a){a.added=manager.varCache.trColumnList.added.display},24:function(a){a.completed=manager.varCache.trColumnList.completed.display},22:function(a){a.data_sid=1},26:function(a){a.data_path=1}},trItemNodeUpdate:{data_label:function(a){a.node.dataset.label=a.api[11]},data_sid:function(a){a.node.dataset.sid=
a.api[22]},data_path:function(a){a.node.dataset.path=a.api[26]}},trItemUpdate:function(a,b){manager.trItemIsInFilter(b)?1===b.display&&(b.node.classList.add("filtered"),b.display=0):1!==b.display&&(b.node.classList.remove("filtered"),b.display=1);for(var c={},d=0,e=a.length;d<e;d++)manager.trApiIndexToChanges[a[d]](c);for(var f in c)1===c[f]&&(a=b.cell[f],void 0!==a?a(b.api):(a=manager.trItemNodeUpdate[f],void 0!==a&&a(b)))},trSkipItem:function(a){if(manager.settings.hideSeedStatusItem&&1E3===a[4]&&
201===a[1]||manager.settings.hideFnishStatusItem&&1E3===a[4]&&136===a[1])return!0},trColumnToApiIndex:{checkbox:void 0,name:2,order:17,size:3,remaining:"remaining",done:4,status:1,seeds:15,peers:13,seeds_peers:14,downspd:9,upspd:8,eta:10,upped:6,downloaded:5,shared:7,avail:16,label:11,added:23,completed:24,actions:void 0},onSort:function(a,b,c,d,e){d=d.api;e=e.api;if("string"===typeof b)if("remaining"===b){var f=d[3]-d[5];var g=e[3]-e[5]}else if("done"===b)f=100*d[2]/d[1],g=100*e[2]/e[1];else return 0;
else f=d[b],g=e[b];if("tr"===a&&(1===b&&(201===f&&1E3>d[4]&&(f+=50),201===g&&1E3>e[4]&&(g+=50)),24===b&&(0===f||0===g))){if(f===g)return 0;if(f<g)return 1===c?1:-1;if(f>g)return 1===c?-1:1}if(f===g)return 0;if(f<g)return 1===c?-1:1;if(f>g)return 1===c?1:-1},sortInsertList:function(a,b,c){for(var d=[],e,f,g=0;e=b[g];g++)if(c[g]!==e){e=g;for(f=document.createDocumentFragment();void 0!==b[g]&&b[g]!==c[g];){var h=c.indexOf(b[g],g);-1!==h&&c.splice(h,1);c.splice(g,0,b[g]);f.appendChild(b[g].node);g++}d.push({pos:e,
list:f})}b=manager.domCache[a+"Body"];for(g=0;e=d[g];g++)0===e.pos?(f=b.firstChild,null===f?b.appendChild(e.list):b.insertBefore(e.list,f)):void 0!==b.childNodes[e.pos]?b.insertBefore(e.list,b.childNodes[e.pos]):b.appendChild(e.list);manager.varCache[a+"SortList"]=c},sort:function(a,b,c){void 0===b&&(b=manager.varCache[a+"SortColumn"]);void 0===c&&(c=manager.varCache[a+"SortBy"]);manager.varCache[a+"SortColumn"]=b;manager.varCache[a+"SortBy"]=c;b=manager[a+"ColumnToApiIndex"][b];void 0===b&&(b="");
var d=[],e;for(e in manager.varCache[a+"ListItems"])d.push(manager.varCache[a+"ListItems"][e]);d.sort(manager.onSort.bind(void 0,a,b,c));manager.sortInsertList(a,d,manager.varCache[a+"SortList"])},setSummSpeed:function(a,b){b=manager.bytesToText(b,"-",1);if(!manager.domCache[a+"Spd"])return manager.domCache[a+"Speed"].appendChild(manager.domCache[a+"Spd"]=utils.create("span",{class:"sum "+a,text:b}));manager.domCache[a+"Spd"].textContent=b},trRemoveItem:function(a){var b=manager.varCache.trListItems[a];
b&&(manager.varCache.trSortList.splice(manager.varCache.trSortList.indexOf(b),1),b.node.parentNode.removeChild(b.node),delete manager.varCache.trListItems[a])},trFullUpdatePrepare:function(a){for(var b=[],c=0,d;d=manager.varCache.trSortList[c];c++){var e=d.api[0],f=!1;d=0;for(var g;g=a[d];d++)if(g[0]===e){f=!0;break}f||b.push(e)}for(d=0;a=b[d];d++)manager.trRemoveItem(a)},labelsEqual:function(a,b){var c=a.length;if(c!==b.length)return!1;for(;c--;)if(a[c][0]!==b[c][0])return!1;return!0},writeTrList:function(a){if(a){void 0!==
a.torrentc&&(manager.varCache.cid=a.torrentc);if(void 0!==a.torrentm)for(var b=0,c;c=a.torrentm[b];b++)manager.trRemoveItem(c);void 0!==a.torrents&&manager.trFullUpdatePrepare(a.torrents);var d=a.torrents||a.torrentp;if(void 0!==d){var e=0,f=0;b=0;for(var g;g=d[b];b++)if(e+=g[9],f+=g[8],!manager.trSkipItem(g)){c=g[0];var h=manager.varCache.trListItems[c];void 0===h?(h=manager.varCache.trListItems[c]={},h.api=g,manager.trItemCreate(h)):(c=manager.trGetApiDiff(h.api,g),0!==c.length&&(h.api=g,manager.trItemUpdate(c,
h)))}manager.setSummSpeed("dl",e);manager.setSummSpeed("up",f);manager.sort("tr")}void 0!==a.files&&manager.writeFlList(a);a.label&&!manager.labelsEqual(a.label,manager.varCache.remoteLabels)&&(manager.varCache.remoteLabels=a.label,manager.setLabels(a.label));void 0!==d&&manager.settings.showSpeedGraph&&manager.varCache.hasGraph&&graph.move(e,f)}},extend:function(a,b){for(var c in b)a[c]=b[c]},updateTrackerList:function(a){manager.timer.wait=!0;var b={list:1};void 0!==manager.varCache.flListLayer.param&&
manager.extend(b,manager.varCache.flListLayer.param);manager.api(b,function(b){manager.timer.wait=!1;a&&a();manager.writeTrList(b)})},timer:{timer:void 0,wait:!1,start:function(){var a=this;this.wait=!1;clearInterval(this.timer);this.timer=setInterval(function(){a.wait||manager.updateTrackerList()},manager.settings.popupUpdateInterval)},stop:function(){clearInterval(this.timer)}},flCreateSmartName:function(a,b){void 0===a.smartName&&(a.smartName={mod_name:!1,show:!1});var c=!1;-1===b&&(c=!0,b=0);
void 0===b&&(b=0);var d=a.api[0],e=[];if(c){var f=d.split("/");c=f.splice(-1)[0];d=[];for(var g=0,h;h=f[g];g++){d.push(h);var k=d.join("/");e.push({path:k,name:h,back:f.slice(0,g).join("/")});void 0===manager.varCache.flSmartName[k]&&(manager.varCache.flSmartName[k]={items:[],path:f.slice(g),level:g+1,links:e.slice(0)});-1===manager.varCache.flSmartName[k].items.indexOf(a.index)&&manager.varCache.flSmartName[k].items.push(a.index)}}else c=d.lastIndexOf("/"),e=d.substr(0,c),c=d.substr(c+1),e=manager.varCache.flSmartName[e].links;
d=document.createDocumentFragment();0!==b&&(g=b-1,d.appendChild(utils.create("a",{class:"folder c"+g,text:"\u2190",href:"#",data:{path:e[g].back}})));for(g=b;b=e[g];g++)d.appendChild(utils.create("a",{class:"folder c"+g,text:b.name,href:"#",data:{path:b.path}}));return{text:c,link:d}},flOnSmartNameClick:function(a){a=manager.varCache.flSmartName[a];if(void 0===a){for(var b in manager.varCache.flListItems){var c=manager.varCache.flListItems[b];if(!0===c.smartName.mod_name){var d=manager.flCreateSmartName(c);
c.cell.name(void 0,d)}}b=manager.varCache["style.fl-filter"];delete manager.varCache["style.fl-filter"];b&&b.parentNode.removeChild(b)}else{for(b in manager.varCache.flListItems)c=manager.varCache.flListItems[b],!0===c.smartName.show&&-1===a.items.indexOf(c.index)&&(c.smartName.show=!1,c.node.classList.remove("show"));for(var e=a.level,f=0,g=a.items.length;f<g;f++)b=a.items[f],c=manager.varCache.flListItems[b],d=manager.flCreateSmartName(c,e),!1===c.smartName.show&&(c.node.classList.add("show"),c.smartName.show=
!0),c.cell.name(void 0,d),c.smartName.mod_name=!0;b=manager.varCache["style.fl-filter"];delete manager.varCache["style.fl-filter"];b&&b.parentNode.removeChild(b);document.body.appendChild(manager.varCache["style.fl-filter"]=utils.create("style",{class:"fl-filter",text:".fl-table-body tbody > tr{display: none;}.fl-table-body tbody > tr.show{display:table-row;}"}))}},flCreateCell:{checkbox:function(a,b){return{node:utils.create("td",{class:a,append:utils.create("input",{type:"checkbox"})})}},name:function(a,
b,c){var d,e=utils.create("td",{class:a,append:utils.create("div",{append:[d=utils.create("span")]})});a=function(a,b){void 0===b&&(b=manager.flCreateSmartName(c,-1));e.title=b.text;d.textContent=b.text;d.insertBefore(b.link,d.firstChild)};a(b);return{node:e,update:a}},size:function(a,b){return{node:utils.create("td",{class:a,append:utils.create("div",{text:manager.bytesToText(b[1],"0")})})}},downloaded:function(a,b){var c;a=utils.create("td",{class:a,append:c=utils.create("div")});var d=function(a){c.textContent=
manager.bytesToText(a[2],"0")};d(b);return{node:a,update:d}},done:function(a,b){var c,d;a=utils.create("td",{class:a,append:utils.create("div",{class:"progress_b",append:[c=utils.create("div",{class:"val"}),d=utils.create("div",{class:"progress_b_i"})]})});var e=function(a){var b=a[1]===a[2]&&0!==a[3]?"#41B541":"#3687ED";a=Math.round(100*a[2]/a[1]*10)/10;c.textContent=a+"%";d.style.width=Math.round(a)+"%";d.style.backgroundColor=b};e(b);return{node:a,update:e}},prio:function(a,b){var c=["MF_DONT",
"MF_LOW","MF_NORMAL","MF_HIGH"],d,e=utils.create("td",{class:a,append:d=utils.create("div")});a=function(a){a=manager.language[c[a[3]]];e.title=a;d.textContent=a};a(b);return{node:e,update:a}}},flItemCreate:function(a){a.cell={};a.node=utils.create("tr",{data:{index:a.index},append:function(){for(var b=[],c=0,d;d=manager.varCache.flColumnArray[c];c++){var e=d.column;1===d.display&&(d=manager.flCreateCell[e](e,a.api,a),a.cell[e]=d.update,b.push(d.node))}return b}()})},flApiIndexToChanges:{0:function(a){a.name=
manager.varCache.flColumnList.name.display},1:function(a){a.size=manager.varCache.flColumnList.size.display},2:function(a){a.downloaded=manager.varCache.flColumnList.downloaded.display;a.done=manager.varCache.flColumnList.done.display},3:function(a){a.prio=manager.varCache.flColumnList.prio.display;a.done=manager.varCache.flColumnList.done.display}},flGetApiDiff:function(a,b){var c=b;a.length<c.length&&(c=a,a=b);b=[];for(var d=0,e=a.length;d<e;d++)void 0!==manager.flApiIndexToChanges[d]&&a[d]!==c[d]&&
b.push(d);return b},flItemUpdate:function(a,b){for(var c={},d=0,e=a.length;d<e;d++)manager.flApiIndexToChanges[a[d]](c);for(var f in c)1===c[f]&&(a=b.cell[f],void 0!==a&&a(b.api))},flColumnToApiIndex:{checkbox:void 0,name:0,size:1,downloaded:2,done:"done",prio:3},flClearList:function(){manager.varCache.flSmartName={};manager.varCache.flSortList=[];manager.varCache.flListItems={};manager.domCache.flBody.textContent="";var a=manager.varCache["style.fl-filter"];delete manager.varCache["style.fl-filter"];
a&&a.parentNode.removeChild(a)},writeFlList:function(a){if(a.files){var b=manager.varCache.flListLayer;if(a.files[0]===b.hash&&(a=a.files[1],0!==a.length)){for(var c=0,d;d=a[c];c++){var e=manager.varCache.flListItems[c];if(void 0===e)e=manager.varCache.flListItems[c]={},e.api=d,e.index=c,manager.flItemCreate(e);else{var f=manager.flGetApiDiff(e.api,d);0!==f.length&&(e.api=d,manager.flItemUpdate(f,e))}}b.loading&&(b.loading.parentNode.removeChild(b.loading),delete b.loading);manager.sort("fl")}}},
flListShow:function(a){var b=manager.varCache.flListLayer={};b.hash=a;var c={action:"getfiles",hash:a},d=manager.varCache.trListItems[a],e=d.node;e.classList.add("selected");manager.unCheckAll("tr");var f=manager.options.trHasSelectCell?e.getElementsByTagName("input")[0]:void 0;f&&(f.checked=!0,f.dispatchEvent(new CustomEvent("change",{bubbles:!0})));document.body.appendChild(b.closeLayer=utils.create("div",{class:"file-list-layer-temp",on:["mousedown",function(){b.close()}]}));manager.flWriteHead();
manager.domCache.flLayer.appendChild(b.loading=utils.create("div",{class:"file-list-loading",style:{top:manager.varCache.flHeight/2-15+"px",left:manager.varCache.flWidth/2-15+"px"}}));a=manager.domCache.flBottom.querySelector("li.path > input");d=d.api[26];utils.create(a,{title:d,value:d});mono.sendMessage({action:"api",data:c},function(a){manager.writeFlList(a);b.param=c});manager.domCache.fl.style.display="block";a.focus();b.close=function(){manager.varCache.flListLayer={};manager.domCache.fl.style.display=
"none";b.closeLayer.parentNode.removeChild(b.closeLayer);e.classList.remove("selected");f&&(f.checked=!1,f.dispatchEvent(new CustomEvent("change",{bubbles:!0})));manager.domCache.flFixedHead.removeChild(manager.domCache.flFixedHead.firstChild);manager.domCache.flHead.removeChild(manager.domCache.flHead.firstChild);manager.flClearList();b.loading&&(b.loading.parentNode.removeChild(b.loading),delete b.loading)}},setColumSort:function(a,b,c,d){for(var e=manager.domCache[d+"FixedHead"].querySelectorAll([".sortDown",
".sortUp"]),f=0,g;g=e[f];f++)g.classList.remove("sortDown"),g.classList.remove("sortUp");c=void 0===c?manager.varCache[d+"SortBy"]:c?0:1;e={};e[d+"SortOptions"]={column:b,by:c};manager.varCache[d+"SortBy"]=c;manager.varCache[d+"SortColumn"]=b;manager.sort(d);c&&a.classList.add("sortDown");!c&&a.classList.add("sortUp");mono.storage.local.set(e)},updateHead:function(a){var b=manager.domCache[a+"FixedHead"].firstChild;b&&b.parentNode.removeChild(b);(b=manager.domCache[a+"Head"].firstChild)&&b.parentNode.removeChild(b);
manager[a+"WriteHead"]()},capitalize:function(a){return a.substr(0,1).toUpperCase()+a.substr(1)},tableResize:function(a){a.stopPropagation();if(0===a.button){var b=manager.tableResize;b.enable=!0;var c=this.parentNode;this.classList.contains("last")||(c=c.previousElementSibling);if(null!==c){var d=c.dataset.type,e=c.dataset.name,f=this.parentNode;f.draggable=!1;var g=c.clientWidth,h=a.clientX,k=0;a="tr"===d?"torrent-list":"fl";var n="."+a+"-layer th."+e+", ."+a+"-layer td."+e+" {max-width: {size}px;min-width: {size}px;}",
l=utils.create("style");document.body.appendChild(l);document.body.style.width=document.body.clientWidth+"px";var m=g,p=function(a){k=a.clientX-h-6;m=g+k;16>m&&(m=16);l.textContent=n.replace(/\{size}/g,m)};document.body.addEventListener("mousemove",p);document.body.addEventListener("mouseup",function q(a){a.stopPropagation();b.enable=!1;document.body.removeEventListener("mousemove",p);document.body.removeEventListener("mouseup",q);l.parentNode.removeChild(l);document.body.style.width="initial";manager.varCache[d+
"ColumnList"][e].width=m;mono.sendMessage({action:"set"+manager.capitalize(d)+"ColumnArray",data:manager.varCache[d+"ColumnArray"]});manager.updateHead(d);f.draggable=!0})}}},prepareColumnList:function(a){for(var b={},c=0,d;d=a[c];c++)b[d.column]=d;return b},trReadStatus:function(a){var b=a[1];a=!!(b&64);var c=!!(b&32),d=!!(b&2);b=!!(b&1);a={recheck:d||b||a?0:1,stop:d||b||a?1:0,unpause:(b||d)&&c?1:0,pause:!c&&(d||b||a)?1:0,start:!a||c?1:0,forcestart:b&&!a&&!c||d?0:1};1===a.pause&&(a.unpause=0);return a},
updateLabesCtx:function(a,b){a.items.labels.$node.children("ul");var c=b?manager.varCache.trListItems[b].api[11]:"";var d=a.items.labels.items;c||!b?(void 0===d.delLabel&&(d.delLabel={name:manager.language.OV_REMOVE_LABEL,$node:$("<li>",{"class":"context-menu-item"}).data({contextMenuKey:"delLabel",contextMenu:a.items.labels,contextMenuRoot:a}).append($("<span>",{text:manager.language.OV_REMOVE_LABEL}))},d.delLabel.$node.prependTo(a.items.labels.$node.children("ul")),a.callbacks.delLabel=function(){manager.api({list:1,
action:"setprops",s:"label",hash:manager.varCache.trSelectedHashList,v:""});manager.unCheckAll("tr",1)}),void 0!==d.addLabel&&(d.addLabel.$node.remove(),delete d.addLabel)):(void 0===d.addLabel&&(d.addLabel={name:manager.language.OV_NEW_LABEL,$node:$("<li>",{"class":"context-menu-item"}).data({contextMenuKey:"addLabel",contextMenu:a.items.labels,contextMenuRoot:a}).append($("<span>",{text:manager.language.OV_NEW_LABEL}))},d.addLabel.$node.prependTo(a.items.labels.$node.children("ul")),a.callbacks.addLabel=
function(){var a=this;this.addClass("force");var b=manager.varCache.trSelectedHashList.slice(0);showNotification([[{label:{text:manager.language.OV_NEWLABEL_CAPTION}},{input:{type:"text",name:"label",focus:!0,on:[["keydown",function(a){13===a.keyCode&&this.nodeCache.yesBtn.trigger("click")}]]}}],[{input:{type:"button",value:manager.language.DLG_BTN_APPLY,name:"yesBtn",on:["click",function(){var a=this.getFormData();this.close();(a=a.label)&&manager.api({list:1,action:"setprops",s:"label",hash:b,v:a})}]}},
{input:{type:"button",value:manager.language.DLG_BTN_CANCEL,name:"noBtn",on:["click",function(){this.close()}]}}]],function(){manager.unCheckAll("tr",1);a.removeClass("selected")})}),void 0!==d.delLabel&&(d.delLabel.$node.remove(),delete d.delLabel));var e=0;b=manager.varCache.labelList.slice(0);for(var f=0,g;g=manager.varCache.labels[f];f++)g.custom||-1===b.indexOf(g.label)&&b.push(g.label);f=0;for(var h;h=b[f];f++)e++,void 0===d["_"+h]&&(d["_"+h]={name:h,$node:$("<li>",{"class":"context-menu-item"}).data({label:h,
contextMenuKey:"_"+h,contextMenu:a.items.labels,contextMenuRoot:a}).append($("<span>",{text:h}))},d["_"+h].$node.appendTo(a.items.labels.$node.children("ul")),a.callbacks["_"+h]=function(a,b){manager.api({list:1,action:"setprops",s:"label",hash:manager.varCache.trSelectedHashList,v:b.items.labels.items[a].name});manager.unCheckAll("tr",1)});0<e?(void 0===d.s&&(d.s={name:"-",$node:$("<li>",{"class":"context-menu-item  context-menu-separator not-selectable"}).data({contextMenuKey:"s",contextMenu:a.items.labels,
contextMenuRoot:a})}),void 0!==d.delLabel?d.delLabel.$node.after(d.s.$node):d.addLabel.$node.after(d.s.$node)):void 0!==d.s&&(d.s.$node.remove(),delete d.s);for(var k in d)if("_"===k[0]){g=d[k];a=!1;for(f=0;h=b[f];f++)if(h===g.name){a=!0;break}a?g.name!==c?(g.labelNode&&g.labelNode.remove(),delete g.labelNode):void 0===g.labelNode&&g.$node.prepend(g.labelNode=$("<label>",{text:"\u25cf"})):(g.$node.remove(),delete d[k])}},getSpeedArray:function(a,b){0===a&&(a=512);a<Math.round(b/2)&&(a=Math.round(b/
2));for(var c=Array(b),d=0;d<b;d++)c[d]=Math.round((d+1)/Math.round(b/2)*a);return c},setSpeedDom:function(a,b){var c=manager.varCache.speedLimit[a+"Node"];0===b?c&&(c.parentNode.removeChild(c),delete manager.varCache.speedLimit[a+"Node"]):(b=manager.bytesToText(1024*b,"-",1),void 0===c?(c=manager.varCache.speedLimit[a+"Node"]=utils.create("span",{"class":"limit "+a,text:b}),manager.domCache[a+"Speed"].appendChild(c)):c.textContent=b)},updateSpeedCtxMenu:function(){var a=manager.varCache.speedLimit.ctxItems,
b=manager.varCache.speedLimit.type;if(a){var c=manager.getSpeedArray(manager.varCache.speedLimit[b+"Speed"]||0,manager.varCache.speedLimit.count),d=0,e;for(e in a){var f=a[e];void 0!==f.name&&("unlimited"!==e&&(f.speed!==c[d]&&(f.speed=c[d],f.$node.children("span").text(manager.bytesToText(1024*f.speed,void 0,1))),d++),f.type!==b&&(f.type=b),manager.varCache.speedLimit[b+"Speed"]!==f.speed?(f.labelNode&&f.labelNode.remove(),delete f.labelNode):void 0===f.labelNode&&f.$node.prepend(f.labelNode=$("<label>",
{text:"\u25cf"})))}}},readSettings:function(a){for(var b=0,c;c=a.settings[b];b++){var d=c[0];c=c[2];"max_dl_rate"===d&&(c=parseInt(c),manager.varCache.speedLimit.dlSpeed!==c&&(manager.varCache.speedLimit.dlSpeed=c,manager.setSpeedDom("dl",c)));"max_ul_rate"===d&&(c=parseInt(c),manager.varCache.speedLimit.upSpeed!==c&&(manager.varCache.speedLimit.upSpeed=c,manager.setSpeedDom("up",c)))}manager.updateSpeedCtxMenu()},trToggleColum:function(a){manager.timer.stop();a=manager.varCache.trColumnList[a];a.display=
1===a.display?0:1;manager.updateHead("tr");manager.trFullUpdatePrepare([]);utils.joinMessages([{action:"getRemoteTorrentList"},{action:"setTrColumnArray",data:manager.varCache.trColumnArray}]).then(function(a){manager.writeTrList({torrents:a.getRemoteTorrentList});manager.timer.start()})},flToggleColum:function(a){var b=manager.varCache.flListLayer;b.param&&(manager.timer.stop(),a=manager.varCache.flColumnList[a],a.display=1===a.display?0:1,manager.updateHead("fl"),manager.flClearList(),utils.joinMessages([{action:"api",
data:b.param},{action:"setFlColumnArray",data:manager.varCache.flColumnArray}]).then(function(a){manager.writeFlList(a.api);manager.timer.start()}))},setSpeedLimit:function(a,b){mono.sendMessage({action:"api",data:{action:"setsetting",s:"max_"+("dl"===a?"dl":"ul")+"_rate",v:b}});manager.varCache.speedLimit[a+"Speed"]=b;manager.setSpeedDom(a,b)},getCheckBoxList:function(a,b,c){if(!manager.options[a+"HasSelectCell"])return[];b=0===b?":not(:checked)":1===b?":checked":"";a=""===b?manager.domCache[a+"Body"].getElementsByTagName("input"):
manager.domCache[a+"Body"].querySelectorAll("input"+b);if(!c)return a;c=[];b=0;for(var d;d=a[b];b++)utils.isVisibleElement(d)&&c.push(d);return c},selectRangeCheckBox:function(a,b,c){if(manager.options[a+"HasSelectCell"]){var d=manager.varCache[a+"ListItems"],e=manager.varCache[a+"SortList"];b=b.map(function(a){return e.indexOf(d[a])});b[0]>b[1]&&b.reverse();manager.unCheckAll(a,1);for(var f=b[0];f<=b[1];f++){var g=e[f];if(g){g=g.node;var h=g.getElementsByTagName("input")[0];!h||c&&!utils.isVisibleElement(h)||
(h.checked=!0,g.classList.add("selected"))}}manager.selectAllCheckBox(a)}},selectAllCheckBox:function(a){if(manager.options[a+"HasSelectCell"]){for(var b=manager.getCheckBoxList(a,void 0,"fl"===a),c=0,d=0,e;e=b[d];d++)e.checked&&c++;if(a=manager.domCache[a+"FixedHead"].getElementsByTagName("input")[0])a.checked=c===b.length}},unCheckAll:function(a,b){if(manager.options[a+"HasSelectCell"]){b=manager.getCheckBoxList(a,1,b);for(var c=0,d;d=b[c];c++)d.checked=!1,d.parentNode.parentNode.classList.remove("selected");
manager.selectAllCheckBox(a)}},flForceSetFilePriority:function(a,b){for(var c=0,d=b.length;c<d;c++){var e=manager.varCache.flListItems[b[c]];e&&(e.api[3]=a,e.cell.prio&&e.cell.prio(e.api),e.cell.done&&e.cell.done(e.api))}},setPriority:function(a,b,c){for(var d=0,e=0,f=0,g=function(){e++;e===d&&a===manager.varCache.flListLayer.hash&&(manager.flForceSetFilePriority(c,b),manager.unCheckAll("fl",1))};void 0!==b[f];){d++;var h=b.slice(f,f+500);f+=500;mono.sendMessage({action:"api",data:{action:"setprio",
p:c,hash:a,f:h}},g)}},setCheckboxState:function(a,b,c){if(c){if(b.classList.contains("selected"))return b.classList.add("force");b.classList.add("selected");manager.options[a+"HasSelectCell"]&&(a=b.getElementsByTagName("input")[0],void 0!==a&&(a.checked=!0,a.dispatchEvent(new CustomEvent("change",{bubbles:!0}))))}else if(b.classList.contains("selected")){if(b.classList.contains("force"))return b.classList.remove("force");if("tr"!==a||manager.varCache.flListLayer.hash!==b.id)b.classList.remove("selected"),
manager.options[a+"HasSelectCell"]&&(a=b.getElementsByTagName("input")[0],void 0!==a&&(a.checked=!1,a.dispatchEvent(new CustomEvent("change",{bubbles:!0}))))}},onLoadContextMenu:function(){$.contextMenu.defaults.delay=0;$.contextMenu.defaults.animation.hide="hide";$.contextMenu.defaults.animation.show="show";$.contextMenu.defaults.animation.duration=0;$.contextMenu.defaults.position=function(a,b,c){if(b||c){b="maintain"===b&&"maintain"===c?a.$menu.position():{top:c,left:b+5};var d=$(window);a.$menu.css({height:"initial",
overflow:"initial"});c=null!==a.$menu[0].querySelector(".context-menu-submenu");var e=d.scrollTop()+d.height();d=d.scrollLeft()+d.width();var f=a.$menu.height(),g=a.$menu.width();c||(b.overflow="auto");b.top+f>e&&(b.top-=b.top+f-e+1);if(f+2>=e||0>b.top)b.top=1,b.height=e-2;b.left+g>d&&(b.left-=g+10);a.$menu.css(b)}else a.determinePosition.call(this,a.$menu)};$.contextMenu.defaults.positionSubmenu=function(a){var b=this.height()+2,c=this.offset().top,d=this.parent(),e=d.offset().left,f=d.width(),g=
document.body.clientWidth;d=document.body.clientHeight;var h=a.height();b=-parseInt((h-b)/2);var k=a.width();e=k+f+e>g?-k-1:this.outerWidth()-1;f=!1;document.body.scrollHeight>d&&(f=!0,a[0].classList.add("forceHidden"));d=document.body.clientHeight;f&&a[0].classList.remove("forceHidden");0>c+b+h?b=-c:c+b+h>d&&(b-=c+b+h-d+2);a.css({top:b,left:e})};$.contextMenu({zIndex:3,selector:".torrent-table-body tr",className:"torrent",events:{show:function(a){manager.setCheckboxState("tr",this[0],1);manager.varCache.trSelectedHashList=
[];var b=this[0].id;if(manager.options.trHasSelectCell)for(var c=manager.getCheckBoxList("tr",1,1),d=0,e;e=c[d];d++)manager.varCache.trSelectedHashList.push(e.parentNode.parentNode.id);else manager.varCache.trSelectedHashList.push(b);if(1<manager.varCache.trSelectedHashList.length)for(c=[],d={order:1,torrent_files:0},e=0;b=manager.varCache.trSelectedHashList[e];e++){b=manager.trReadStatus(manager.varCache.trListItems[b].api);for(var f in b)1!==d[f]&&(d[f]=b[f])}else c=manager.varCache.trListItems[b].api,
d=manager.trReadStatus(c);for(f in a.items)if(e=a.items[f],"labels"===f){var g=c[11];e.label!==g&&(g?(e.labelNode?e.labelNode.text(g):e.$node.children("span").append(e.labelNode=$("<i>",{text:g})),e.label=g):(e.labelNode&&e.labelNode.remove(),delete e.labelNode,delete e.label))}else g=d[f],void 0===g?0===e.display&&(e.display=1,e=e.$node[0],e.classList.remove("hidden"),e.classList.remove("not-selectable"),e.style.display="block"):g!==e.display&&(e.display=g,e=e.$node[0],1===g?(e.classList.remove("hidden"),
e.classList.remove("not-selectable"),e.style.display="block"):(e.classList.add("hidden"),e.classList.add("not-selectable"),e.style.display="none"));manager.updateLabesCtx(a,b)},hide:function(){manager.setCheckboxState("tr",this[0],0);manager.varCache.trSelectedHashList=[]}},items:{start:{name:manager.language.ML_START,callback:function(){manager.api({list:1,action:"start",hash:manager.varCache.trSelectedHashList});manager.unCheckAll("tr",1)}},forcestart:{name:manager.language.ML_FORCE_START,callback:function(){manager.api({list:1,
action:"forcestart",hash:manager.varCache.trSelectedHashList});manager.unCheckAll("tr",1)}},pause:{name:manager.language.ML_PAUSE,callback:function(){manager.api({list:1,action:"pause",hash:manager.varCache.trSelectedHashList});manager.unCheckAll("tr",1)}},unpause:{name:manager.language.resume,callback:function(){manager.api({list:1,action:"unpause",hash:manager.varCache.trSelectedHashList});manager.unCheckAll("tr",1)}},stop:{name:manager.language.ML_STOP,callback:function(){manager.api({list:1,action:"stop",
hash:manager.varCache.trSelectedHashList});manager.unCheckAll("tr",1)}},s1:"-",recheck:{name:manager.language.ML_FORCE_RECHECK,callback:function(){manager.api({list:1,action:"recheck",hash:manager.varCache.trSelectedHashList});manager.unCheckAll("tr",1)}},remove:{name:manager.language.ML_REMOVE,callback:function(){var a=this;this.addClass("force");var b=manager.varCache.trSelectedHashList.slice(0),c=1!==b.length?"":manager.varCache.trListItems[b[0]].api[2];showNotification([[{label:{text:c?manager.language.OV_CONFIRM_DELETE_ONE:
manager.language.OV_CONFIRM_DELETE_MULTIPLE.replace("%d",b.length)}},{span:{text:c,class:"fileName"}}],[{input:{type:"button",value:manager.language.DLG_BTN_YES,on:[["click",function(){this.close();manager.api({list:1,action:"remove",hash:b})}]]}},{input:{type:"button",value:manager.language.DLG_BTN_NO,focus:!0,on:[["click",function(){this.close()}]]}}]],function(){manager.unCheckAll("tr",1);a.removeClass("selected")})}},remove_with:{name:manager.language.ML_REMOVE_AND,items:{remove_torrent:{name:manager.language.ML_DELETE_TORRENT,
callback:function(){var a={list:1,action:"removetorrent",hash:manager.varCache.trSelectedHashList};void 0===manager.varCache.trListItems[a.hash[0]].api[21]&&(a.action="remove");manager.api(a);manager.unCheckAll("tr",1)}},remove_files:{name:manager.language.ML_DELETE_DATA,callback:function(){manager.api({list:1,action:"removedata",hash:manager.varCache.trSelectedHashList});manager.unCheckAll("tr",1)}},remove_torrent_files:{name:manager.language.ML_DELETE_DATATORRENT,callback:function(){var a={list:1,
action:"removedatatorrent",hash:manager.varCache.trSelectedHashList};void 0===manager.varCache.trListItems[a.hash[0]].api[21]&&(a.action="removedata");manager.api(a);manager.unCheckAll("tr",1)}}}},s2:"-",order:{name:manager.language.OV_COL_ORDER,items:{up:{name:manager.language.up,callback:function(){manager.api({list:1,action:"queueup",hash:manager.varCache.trSelectedHashList});manager.unCheckAll("tr",1)}},down:{name:manager.language.down,callback:function(){manager.api({list:1,action:"queuedown",
hash:manager.varCache.trSelectedHashList});manager.unCheckAll("tr",1)}}}},torrent_files:{name:manager.language.showFileList,callback:function(){manager.flListShow(manager.varCache.trSelectedHashList[0])}},labels:{name:manager.language.OV_COL_LABEL,className:"labels",label:"",items:{}}}});$.contextMenu({selector:".fl-table-body tr",className:"filelist",events:{show:function(a){manager.setCheckboxState("fl",this[0],1);manager.varCache.flListLayer.ctxSelectArray=[];var b=this[0].dataset.index;if(manager.options.flHasSelectCell)for(var c=
manager.getCheckBoxList("fl",1,1),d=0,e;e=c[d];d++)manager.varCache.flListLayer.ctxSelectArray.push(e.parentNode.parentNode.dataset.index);else manager.varCache.flListLayer.ctxSelectArray.push(b);c=1<manager.varCache.flListLayer.ctxSelectArray.length;b=manager.varCache.flListItems[b].api[3];for(var f in a.items)e=a.items[f],void 0!==e.priority&&(e.priority!==b||c?(e.labelNode&&e.labelNode.remove(),delete e.labelNode):void 0===e.labelNode&&e.$node.prepend(e.labelNode=$("<label>",{text:"\u25cf"})))},
hide:function(){manager.setCheckboxState("fl",this[0],0);manager.varCache.flListLayer.ctxSelectArray=[]}},items:{high:{className:"p3",name:manager.language.MF_HIGH,priority:3,callback:function(){var a=manager.varCache.flListLayer.hash,b=manager.varCache.flListLayer.ctxSelectArray.slice(0);manager.setPriority(a,b,3)}},normal:{className:"p2",name:manager.language.MF_NORMAL,priority:2,callback:function(){var a=manager.varCache.flListLayer.hash,b=manager.varCache.flListLayer.ctxSelectArray.slice(0);manager.setPriority(a,
b,2)}},low:{className:"p1",priority:1,name:manager.language.MF_LOW,callback:function(){var a=manager.varCache.flListLayer.hash,b=manager.varCache.flListLayer.ctxSelectArray.slice(0);manager.setPriority(a,b,1)}},s:"-",dntdownload:{className:"p0",priority:0,name:manager.language.MF_DONT,callback:function(){var a=manager.varCache.flListLayer.hash,b=manager.varCache.flListLayer.ctxSelectArray.slice(0);manager.setPriority(a,b,0)}},s1:"-",download:{name:manager.language.DLG_RSSDOWNLOADER_24,callback:function(a,
b){a=manager.varCache.flListLayer.hash;b=manager.varCache.flListLayer.ctxSelectArray;for(var c=0,d=b.length;c<d;c++){var e=manager.varCache.trListItems[a].api[22];void 0!==e&&mono.openTab(manager.varCache.webUiUrl+"proxy?sid="+e+"&file="+b[c]+"&disposition=ATTACHMENT&service=DOWNLOAD&qos=0")}manager.unCheckAll("fl",1)}}}});$.contextMenu({zIndex:2,className:"speed",selector:"table.status-panel td.speed",events:{show:function(a){manager.varCache.speedLimit.ctxItems=a.items;manager.varCache.speedLimit.type=
this.hasClass("download")?"dl":"up";manager.updateSpeedCtxMenu()}},items:function(){var a={};a.unlimited={name:manager.language.MENU_UNLIMITED,speed:0,callback:function(a,b){manager.setSpeedLimit(b.items[a].type,0)}};a.s="-";var b=manager.settings.popupHeight;if(manager.options.windowMode||0===b)b=document.body.clientHeight;b=Math.round((b-54)/27);10<b&&(b=10);manager.options.windowMode&&(b=15);manager.varCache.speedLimit.count=b;for(var c=0;c<b;c++)a["s"+c]={name:"-",speed:void 0,callback:function(a,
b){a=b.items[a];manager.setSpeedLimit(a.type,a.speed)}};return a}()});$.contextMenu({selector:"table.torrent-table-head thead",events:{show:function(a){$.each(manager.varCache.trColumnList,function(b,c){b=a.items[b];c.display!==b.display&&(b.display=c.display,1!==c.display?(b.labelNode&&b.labelNode.remove(),delete b.labelNode):void 0===b.labelNode&&b.$node.prepend(b.labelNode=$("<label>",{text:"\u25cf"})))})}},items:function(){var a={};$.each(manager.varCache.trColumnList,function(b,c){a[b]={name:manager.language[c.lang],
callback:function(a){manager.trToggleColum(a)}}});return a}()});$.contextMenu({className:"flColumSelect",selector:"table.fl-table-head thead",events:{show:function(a){$.each(manager.varCache.flColumnList,function(b,c){b=a.items[b];c.display!==b.display&&(b.display=c.display,1!==c.display?(b.labelNode&&b.labelNode.remove(),delete b.labelNode):void 0===b.labelNode&&b.$node.prepend(b.labelNode=$("<label>",{text:"\u25cf"})))})}},items:function(){var a={};$.each(manager.varCache.flColumnList,function(b,
c){a[b]={name:manager.language[c.lang],callback:function(a){manager.flToggleColum(a)}}});return a}()})},onGotFiles:function(a){var b=function(b){b||(b={});var c=manager.varCache.folderList[b.folder],d;c&&(d={download_dir:c[0],path:c[1]});c=0;for(var e;e=a[c];c++){var k=d,n=b.label;mono.sendMessage({action:"onSendFile",url:URL.createObjectURL(e),folder:k,label:n})}},c=showNotification.selectLabelTemplate(),d=showNotification.selectFolderTemplate();if(0===c[1].select.append.length&&0===d[1].select.append.length)return b();
0===c[1].select.append.length&&(c=void 0);0===d[1].select.append.length&&(d=void 0);showNotification([c,d,[{input:{type:"button",value:manager.language.DLG_BTN_OK,focus:!0,on:[["click",function(){var a=this.getFormData();this.close();b(a)}]]}},{input:{type:"button",value:manager.language.DLG_BTN_CANCEL,on:[["click",function(){this.close()}]]}}]])},onLoadQuickNotification:function(){showNotification.selectLabelTemplate=function(){var a={label:{text:manager.language.OV_COL_LABEL}};var b=[$("<option>",
{text:"",value:""})];for(var c=[],d=0,e;e=manager.varCache.labels[d];d++)e.custom||(c.push(e.label),b.push($("<option>",{text:e.label,value:e.label})));for(d=0;e=manager.varCache.labelList[d];d++)-1===c.indexOf(e)&&b.push($("<option>",{text:e,value:e}));b=1===b.length?[]:b;return[a,{select:{append:b,name:"label"}}]};showNotification.selectFolderTemplate=function(){var a={label:{text:manager.language.ST_CAPT_FOLDER}};var b=[$("<option>",{text:manager.language.defaultPath,value:-1})];for(var c=0,d;d=
manager.varCache.folderList[c];c++)b.push($("<option>",{text:d[2]||d[1],value:c}));b=1===b.length?[]:b;return[a,{select:{append:b,name:"folder"}}]}},calculateMoveble:function(a,b){var c=void 0,d=a.offsetWidth;if(d<=b)a.parentNode.setAttribute("class","title");else{d=Math.ceil(d/10);if(10<d)if(100>d){var e=Math.round(d/10);d=e>d/10?100*e:10*(10*e+5)}else d*=10;else d*=10;e=Math.round(parseInt(d)/parseInt(b)*3.5);var f="moveble_"+b+"_"+d;void 0===manager.varCache.movebleStyleList["style."+f]&&(void 0===
c&&(c=document.createDocumentFragment()),b="{0%{margin-left:2px;}50%{margin-left:-"+(d-b)+"px;}90%{margin-left:6px;}100%{margin-left:2px;}}",c.appendChild(manager.varCache.movebleStyleList["style."+f]=utils.create("style",{class:f,text:"@-webkit-keyframes a_"+f+b+"@keyframes a_"+f+b+"@-moz-keyframes a_"+f+b+"div."+f+":hover > span {overflow: visible;-webkit-animation:a_"+f+" "+e+"s;-moz-animation:a_"+f+" "+e+"s;animation:a_"+f+" "+e+"s;}"})));a.parentNode.setAttribute("class","title "+f);void 0!==
c&&document.body.appendChild(c)}},writeLanguage:function(a){a=(a||document).querySelectorAll("[data-lang]");for(var b=0,c;c=a[b];b++)for(var d=c.dataset.lang.split("|"),e=0,f;f=d[e];e++){f=f.split(",");var g=manager.language[f.shift()];void 0===g?console.log("Language string is not found!",c.dataset.lang):0!==f.length?f.forEach(function(a){if("text"===a)return c.textContent=g,1;c.setAttribute(a,g)}):"DIV"===c.tagName?c.title=g:-1!=="A LEGEND SPAN LI TH P OPTION BUTTON H2 H3".split(" ").indexOf(c.tagName)?
c.textContent=g:"INPUT"===c.tagName?c.value=g:console.log("Tag name not found!",c.tagName)}},onGetFreeSpace:function(a){if(a&&manager.varCache.freeSpace!==a){manager.varCache.freeSpace=a;a=manager.bytesToText(a);var b=manager.domCache.statusPanel.querySelector(".space");b.classList.add("disk");b.title=manager.language.freeSpace+": "+a;b.textContent="";b.appendChild(utils.create("div",{text:a,style:{width:b.clientWidth+"px"},on:["click",function(){manager.getFreeSpace()}]}))}},getFreeSpace:function(){mono.sendMessage({action:"getDirList"},
function(a){if((a=a["download-dirs"])&&a[0]&&(a=1048576*a[0].available,!isNaN(a)))manager.onGetFreeSpace(a)})},run:function(){debug&&console.time("manager");debug&&console.time("remote data");mono.onMessage.addListener(function(a){a&&void 0!==a.setStatus&&manager.setStatus(a.setStatus)});mono.storage.local.get(["trSortOptions","flSortOptions","selectedLabel","folderList","labelList"],function(a){utils.joinMessages([{action:"getLanguage"},{action:"getSettings"},{action:"getTrColumnArray"},{action:"getFlColumnArray"},
{action:"getRemoteTorrentList"},{action:"getRemoteLabels"},{action:"getRemoteSettings"},{action:"getPublicStatus"},{action:"managerIsOpen"}]).then(function(b){debug&&console.timeEnd("remote data");debug&&console.time("manager render");manager.language=b.getLanguage;manager.settings=b.getSettings;if(null===manager.settings.login||null===manager.settings.password)return debug&&console.timeEnd("manager render"),debug&&console.timeEnd("manager"),window.location="options.html";manager.options.windowMode=
mono.isTab();manager.options.trWordWrap&&document.body.appendChild(utils.create("style",{text:"div.torrent-list-layer td div {white-space: normal;word-wrap: break-word;}"}));manager.options.flWordWrap&&document.body.appendChild(utils.create("style",{text:"div.fl-layer td div {white-space: normal;word-wrap: break-word;}"}));manager.options.windowMode?(document.body.parentNode.style.height="100%",document.body.style.height="100%",manager.domCache.trLayer.style.maxHeight="calc(100% - 54px)",manager.domCache.trLayer.style.minHeight=
"calc(100% - 54px)",manager.domCache.trLayer.style.maxWidth="initial"):0<manager.settings.popupHeight&&(manager.domCache.trLayer.style.maxHeight=manager.settings.popupHeight-54+"px",manager.domCache.trLayer.style.minHeight=manager.settings.popupHeight-54+"px");manager.varCache.folderList=a.folderList||manager.varCache.folderList;manager.varCache.labelList=a.labelList||manager.varCache.labelList;a.trSortOptions&&(manager.varCache.trSortColumn=a.trSortOptions.column,manager.varCache.trSortBy=a.trSortOptions.by);
a.flSortOptions&&(manager.varCache.flSortColumn=a.flSortOptions.column,manager.varCache.flSortBy=a.flSortOptions.by);manager.varCache.trColumnList=manager.prepareColumnList(b.getTrColumnArray);manager.varCache.flColumnList=manager.prepareColumnList(b.getFlColumnArray);manager.varCache.trColumnArray=b.getTrColumnArray;manager.varCache.flColumnArray=b.getFlColumnArray;manager.domCache.trLayer.addEventListener("scroll",function(){manager.domCache.trTableFixed.style.left=-this.scrollLeft+"px"});manager.domCache.flLayer.addEventListener("scroll",
function(){manager.domCache.flTableFixed.style.left=0!==this.scrollLeft?-this.scrollLeft+manager.varCache.flLeft+"px":"auto"});manager.trWriteHead();manager.varCache.currentFilter=a.selectedLabel||manager.varCache.currentFilter;manager.setLabels(manager.varCache.remoteLabels=b.getRemoteLabels);manager.trChangeFilterByLabelBox();manager.domCache.labelBox.addEventListener("change",function(){manager.trChangeFilterByLabelBox()});manager.setStatus(b.getPublicStatus);manager.settings.hideSeedStatusItem||
manager.settings.hideFnishStatusItem||(manager.trSkipItem=function(){return!1});manager.writeTrList({torrents:b.getRemoteTorrentList});manager.updateTrackerList(function(){manager.timer.start()});manager.readSettings({settings:b.getRemoteSettings});mono.sendMessage({action:"api",data:{action:"getsettings"}},function(a){manager.readSettings(a)});manager.settings.showFreeSpace&&manager.getFreeSpace();manager.domCache.menu.addEventListener("click",function(a){var b=a.target;if("A"===b.tagName&&b.classList.contains("btn"))if(b.classList.contains("start_all")){a.preventDefault();
a=[];for(var c in manager.varCache.trListItems)b=manager.varCache.trListItems[c],233!==b.api[1]||1!==b.display||0===manager.varCache.currentFilter.custom&&b.api[11]!==manager.varCache.currentFilter.label||a.push(c);0!==a.length&&manager.api({list:1,action:"unpause",hash:a})}else if(b.classList.contains("refresh"))a.preventDefault(),manager.varCache.cid=void 0,manager.updateTrackerList(function(){manager.timer.start()});else if(b.classList.contains("pause_all")){a.preventDefault();a=[];for(c in manager.varCache.trListItems)b=
manager.varCache.trListItems[c],201!==b.api[1]||1!==b.display||0===manager.varCache.currentFilter.custom&&b.api[11]!==manager.varCache.currentFilter.label||a.push(c);0!==a.length&&manager.api({list:1,action:"pause",hash:a})}else b.classList.contains("add_file")?(a.preventDefault(),void 0!==manager.varCache.selectFileInput&&(document.body.removeChild(manager.varCache.selectFileInput),delete manager.varCache.selectFileInput),document.body.appendChild(manager.varCache.selectFileInput=utils.create("input",
{type:"file",multiple:!0,accept:"application/x-bittorrent",style:{display:"none"},on:["change",function(){manager.onGotFiles(this.files);document.body.removeChild(manager.varCache.selectFileInput);delete manager.varCache.selectFileInput}]})),manager.varCache.selectFileInput.click()):b.classList.contains("add_magnet")&&(a.preventDefault(),c=showNotification.selectLabelTemplate(),a=showNotification.selectFolderTemplate(),0===c[1].select.append.length&&(c=void 0),0===a[1].select.append.length&&(a=void 0),
showNotification([[{label:{text:manager.language.Paste_a_torrent_URL}},{input:{type:"text",name:"link",focus:!0,on:[["keydown",function(a){13===a.keyCode&&this.nodeCache.okBtn.trigger("click")}]]}}],c,a,[{input:{type:"button",value:manager.language.DLG_BTN_OK,name:"okBtn",on:[["click",function(){var a=this.getFormData();this.close();var b=manager.varCache.folderList[a.folder],c;b&&(c={download_dir:b[0],path:b[1]});mono.sendMessage({action:"onSendFile",url:a.link,folder:c,label:a.label})}]]}},{input:{type:"button",
value:manager.language.DLG_BTN_CANCEL,on:[["click",function(){this.close()}]]}}]]))});manager.domCache.trBody.addEventListener("dblclick",function(a){for(a=a.target;a&&a!==this&&(a=a.parentNode,"TR"!==a.tagName););a&&(a=a.id)&&manager.flListShow(a)});b=function(a){for(a=a.target;a&&a!==this&&(a=a.parentNode,"TH"!==a.tagName););if(a){var b=a.classList.contains("sortDown")?1:a.classList.contains("sortUp")?0:void 0,c=a.dataset.name,f=a.dataset.type;f&&1===manager.varCache[f+"ColumnList"][c].order&&manager.setColumSort(a,
c,b,f)}};manager.domCache.trFixedHead.addEventListener("click",b);manager.domCache.flFixedHead.addEventListener("click",b);manager.varCache.selectBox=selectBox.wrap(manager.domCache.labelBox);manager.domCache.labelBox.classList.remove("prepare");manager.domCache.trBody.addEventListener("click",function(a){var b=a.target;if("INPUT"===b.tagName){var c=manager.varCache.trLastSelectedHash;c.unshift(b.parentNode.parentNode.id);a.shiftKey?(a=c.slice(-1)[0],c.splice(1),c.push(a),manager.selectRangeCheckBox("tr",
c,1)):c.splice(1)}else"A"===b.tagName&&(b.classList.contains("start")?(a.preventDefault(),c=b.parentNode.parentNode.parentNode.id,manager.api({list:1,action:"start",hash:c})):b.classList.contains("pause")?(a.preventDefault(),c=b.parentNode.parentNode.parentNode.id,manager.api({list:1,action:"pause",hash:c})):b.classList.contains("stop")&&(a.preventDefault(),c=b.parentNode.parentNode.parentNode.id,manager.api({list:1,action:"stop",hash:c})))});manager.domCache.fl.addEventListener("keydown",function(a){27===
a.keyCode&&(a.preventDefault(),manager.varCache.flListLayer.close&&manager.varCache.flListLayer.close())});manager.domCache.flBottom.addEventListener("click",function(a){var b=a.target;"A"===b.tagName&&(b.classList.contains("update")?(a.preventDefault(),mono.sendMessage({action:"api",data:{action:"getfiles",hash:manager.varCache.flListLayer.hash}},function(a){manager.writeFlList(a)})):b.classList.contains("close")&&(a.preventDefault(),manager.varCache.flListLayer.close()))});manager.domCache.statusPanel.addEventListener("click",
function(a){a=a.target;"SPAN"===a.tagName&&a.classList.contains("limit")&&(a=a.classList.contains("dl")?"dl":"up",manager.setSpeedLimit(a,0))});document.body.addEventListener("drop",function(a){a.preventDefault();manager.domCache.dropLayer.classList.add("dropped");a=a.dataTransfer.files;if(a.length)manager.onGotFiles(a)});document.body.addEventListener("dragover",function e(a){2!==a.dataTransfer.types.length&&(a.preventDefault(),manager.domCache.dropLayer.style.display="block",clearTimeout(e.timeout),
e.timeout=setTimeout(function(){manager.domCache.dropLayer.style.display="none";manager.domCache.dropLayer.classList.remove("dropped")},300))});manager.domCache.flBody.addEventListener("click",function(a){var b=a.target;if("INPUT"===b.tagName){var d=manager.varCache.flLastSelectedHash;d.unshift(b.parentNode.parentNode.dataset.index);a.shiftKey?(a=d.slice(-1)[0],d.splice(1),d.push(a),manager.selectRangeCheckBox("fl",d,1)):d.splice(1)}else"A"===b.tagName&&b.classList.contains("folder")&&(manager.flOnSmartNameClick(b.dataset.path),
manager.selectAllCheckBox("fl"))});manager.domCache.trBody.addEventListener("change",function(a){a=a.target;if("INPUT"===a.tagName){var b=a.parentNode.parentNode;a.checked?b.classList.add("selected"):b.classList.remove("selected");manager.selectAllCheckBox("tr")}});manager.domCache.flBody.addEventListener("change",function(a){a=a.target;if("INPUT"===a.tagName){var b=a.parentNode.parentNode;a.checked?b.classList.add("selected"):b.classList.remove("selected");manager.selectAllCheckBox("fl")}});manager.domCache.trFixedHead.addEventListener("change",
function(a){a=a.target;if("INPUT"===a.tagName){if(a.checked){a=manager.getCheckBoxList("tr",0,1);for(var b=0,d;d=a[b];b++)d.checked=!0,d.parentNode.parentNode.classList.add("selected")}else for(a=manager.getCheckBoxList("tr",1,1),b=0;d=a[b];b++)d.checked=!1,d.parentNode.parentNode.classList.remove("selected");manager.selectAllCheckBox("tr")}});manager.domCache.flFixedHead.addEventListener("change",function(a){a=a.target;if("INPUT"===a.tagName)if(a.checked){a=manager.getCheckBoxList("fl",0,1);for(var b=
0,d;d=a[b];b++)d.checked=!0,d.parentNode.parentNode.classList.add("selected")}else for(a=manager.getCheckBoxList("fl",1,1),b=0;d=a[b];b++)d.checked=!1,d.parentNode.parentNode.classList.remove("selected")});manager.varCache.webUiUrl=(manager.settings.useSSL?"https://":"http://")+encodeURIComponent(manager.settings.login)+":"+encodeURIComponent(manager.settings.password)+"@"+manager.settings.ip+":"+manager.settings.port+"/";utils.create(document.querySelector("a.btn.wui"),{href:manager.varCache.webUiUrl+
manager.settings.path});manager.writeLanguage();!manager.options.windowMode&&manager.domCache.upSpeed.appendChild(utils.create("div",{class:"openInTab",title:manager.language.openInTab,on:["click",function(a){mono.openTab(location.href)}]}));!manager.options.windowMode&&setTimeout(function(){var a=manager.settings.popupHeight;0===a&&(a=document.body.clientHeight);document.body.style.minHeight=a+1+"px";setTimeout(function(){document.body.style.minHeight=manager.settings.popupHeight+"px"})},100);debug&&
console.timeEnd("manager render");debug&&console.timeEnd("manager");setTimeout(function(){debug&&console.time("jquery");document.body.appendChild(utils.create("script",{src:"js/jquery-2.1.3.min.js"}))},0)})})}},define=function(a){"jquery"===a?(debug&&console.timeEnd("jquery"),debug&&console.time("contextMenu"),document.body.appendChild(utils.create("script",{src:"js/jquery.contextMenu.js"}))):"contextMenu"===a?(debug&&console.timeEnd("contextMenu"),manager.onLoadContextMenu(),debug&&console.time("quickNotification"),
document.body.appendChild(utils.create("script",{src:"js/notifer.js"}))):"quickNotification"===a?(debug&&console.timeEnd("quickNotification"),manager.onLoadQuickNotification(),manager.settings.showSpeedGraph&&(debug&&console.time("d3js"),document.body.appendChild(utils.create("script",{src:"js/d3.min.js"})))):"graph"===a?manager.varCache.hasGraph=!0:a.hasOwnProperty("version")&&(debug&&console.timeEnd("d3js"),document.body.appendChild(utils.create("script",{src:"js/graph.js"})))};define.amd={};mono.onReady(function(){manager.run()});
